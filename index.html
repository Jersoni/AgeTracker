<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Life Tracker</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>

        <h1 class="age-tracker-header">Age Tracker</h1>

        <main>
            

            <div id="grid">
                <p></p>
                <p></p>
                <p></p>
                <p></p>
                <p></p>
                <p></p>
                <p></p>
                <p></p>
                <p></p>
                <p></p>
                <p></p>
                <p></p>
            </div>

            <div class="bday-date-input-container">
                <label for="bday-date-input">Enter your Birthdate</label>
                <input type="date" id="bday-date-input" class="bday-date-input">
            </div>

            
            
            <div class="bday-time-input-container">
                <label for="bday-time-input">Time of birth <span class="optional">(optional)</span></label>
                <input type="time" id="bday-time-input" class="bday-time-input">
            </div>

            
            <button type="submit" class="submit-button">Convert</button>

            <hr>

            <span class="time-elapsed-header">Time elapsed since</span>
            <span class="time-elapsed-subheader"><u class="header-date">July 23, 2004 @ 11:20 AM</u></span>

            <span class="yrs-label">years </span>
            <span class="years">0</span>

            <span class="mth-label">months </span>
            <span class="months">0</span>

            <span class="wks-label">weeks </span>
            <span class="weeks">0</span>

            <span class="dys-label">days </span>
            <span class="days">0</span>

            <span class="hrs-label">hours </span>
            <span class="hours">0</span>

            <span class="min-label">minutes </span>
            <span class="minutes">0</span>

            <span class="sec-label">seconds </span>
            <span class="seconds">0</span>

            <span class="mil-label">milliseconds </span>
            <span class="milliseconds">0</span>

        </main>


    <script>

        function addCommasEvery3(str) {
            const reversedStr = str.split("").reverse().join("");
            const formattedStr = reversedStr.match(/.{1,3}/g).join(",");
            return formattedStr.split("").reverse().join("");
        }

        setInterval(()=> {

            let buttonSubmit = document.querySelector('.submit-button')
            let inputDate
            let inputTime
            let headerDate = document.querySelector('.header-date')

            // date
            let year = '0000'
            let month = '00'
            let day = '00'

            // time
            let hour = '00'
            let minute = '00'

            // converted date and time
            let convertedMonth
            let convertedHour

            let timePeriod = 'AM'

            function getBirthdateMillis() {
                inputDate = document.querySelector('.bday-date-input').value
                inputTime = document.querySelector('.bday-time-input').value

                year = inputDate.slice(0, 4)
                month = Number(inputDate.slice(5, 7)) - 1
                day = inputDate.slice(8, 10)
                hour = inputTime.slice(0, 2)
                minute = inputTime.slice(3, 5)

                switch(month) {
                    case 0:
                        convertedMonth = 'January'
                        break;
                    case 1:
                        convertedMonth = 'February';
                        break;
                    case 2:
                        convertedMonth = 'March';
                        break;
                    case 3:
                        convertedMonth = 'April';
                        break;
                    case 4:
                        convertedMonth = 'May';
                        break;
                    case 5:
                        convertedMonth = 'June';
                        break;
                    case 6:
                        convertedMonth = 'July';
                        break;
                    case 7:
                        convertedMonth = 'August';
                        break;
                    case 8:
                        convertedMonth = 'September';
                        break;
                    case 9:
                        convertedMonth = 'October';
                        break;
                    case 10:
                        convertedMonth = 'November';
                        break;
                    case 11:
                        convertedMonth = 'December';
                        break;
                    default:
                        convertedMonth = 'no input';
                }

                if (hour > 12){
                    convertedHour = Number(hour) - 12
                    timePeriod = 'PM'
                } else {
                    convertedHour = Number(hour[1])
                }

                if (inputTime == ''){
                    convertedHour = '12'
                    minute = '00'
                }

                let convertedDate = `${convertedMonth} ${day}, ${year} @ ${convertedHour} : ${minute} ${timePeriod}`
                headerDate.innerHTML = convertedDate

                year = Number(year)
                day = Number(day)
                hour = Number(hour)
                minute = Number(minute)

                birthDateMillis = new Date(year, month, day, convertedHour, minute).getTime()

                return birthDateMillis
            }

            buttonSubmit.addEventListener('click', getBirthdateMillis)

            let returnedBirthDateMillis = getBirthdateMillis()

            let years = document.querySelector('.years')
            let months = document.querySelector('.months')
            let weeks = document.querySelector('.weeks')
            let days = document.querySelector('.days')
            let hours = document.querySelector('.hours')
            let minutes = document.querySelector('.minutes')
            let seconds = document.querySelector('.seconds')
            let milliseconds = document.querySelector('.milliseconds')

            let millisecondsSinceBday = Date.now()
            let secondsSinceBday = parseInt((millisecondsSinceBday - returnedBirthDateMillis)/1000)
            let minutesSinceBday = parseInt(((millisecondsSinceBday - returnedBirthDateMillis)/1000) / 60)
            let hoursSinceBday = parseInt(((millisecondsSinceBday - returnedBirthDateMillis)/1000) / 3600)
            let daysSinceBday = parseInt(((millisecondsSinceBday - returnedBirthDateMillis)/1000) / 86400)
            let weeksSinceBday = parseInt(((millisecondsSinceBday - returnedBirthDateMillis)/1000) / 604800)
            let monthsSinceBday = parseInt(((millisecondsSinceBday - returnedBirthDateMillis)/1000) / 2678400)
            let yearsSinceBday = (((millisecondsSinceBday - returnedBirthDateMillis)/1000) / 31536000).toFixed(2)

            if(headerDate.innerHTML == 'no input ,  @ 12 : 00 AM'){
                years.innerHTML = '0'
                months.innerHTML = '0'
                weeks.innerHTML = '0'
                days.innerHTML = '0'
                hours.innerHTML = '0'
                minutes.innerHTML = '0'
                seconds.innerHTML = '0'
                milliseconds.innerHTML = '0'
            } else {
                years.innerHTML = yearsSinceBday
                months.innerHTML = addCommasEvery3(monthsSinceBday + "")
                weeks.innerHTML = addCommasEvery3(weeksSinceBday + "")
                days.innerHTML = addCommasEvery3(daysSinceBday + "")
                hours.innerHTML = addCommasEvery3(hoursSinceBday + "")
                minutes.innerHTML = addCommasEvery3(minutesSinceBday + "")
                seconds.innerHTML = addCommasEvery3(secondsSinceBday + "")
                milliseconds.innerHTML = addCommasEvery3(millisecondsSinceBday + "")
            }

        }, 10)
    
    </script>
</body>
</html>